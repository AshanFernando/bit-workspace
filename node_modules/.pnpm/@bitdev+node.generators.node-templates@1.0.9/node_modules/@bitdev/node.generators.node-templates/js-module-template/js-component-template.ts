import {
  ComponentContext,
  ComponentFile,
  ComponentTemplate,
} from '@teambit/generator';
import { indexFile } from './files/index-file';
import { componentFile } from './files/component';
import { testFile } from './files/test';

// TODO: replace this with "import {ComponentTemplateOptions} from '@teambit/generator';" once v1.3 is released
export type NodeJSComponentTemplateOptions = Partial<Pick<ComponentTemplate, 'name' | 'description' | 'hidden' | 'env'>>;

export class NodeJSComponentTemplate implements ComponentTemplate {
  constructor(
    readonly name = 'module',
    readonly description = 'A node module',
    readonly hidden = false,
    readonly env?: string
  ) {}

  generateFiles(context: ComponentContext): ComponentFile[] {
    return [indexFile(context), componentFile(context), testFile(context)];
  }

  static from(options: NodeJSComponentTemplateOptions = {}) {
    return () =>
      new NodeJSComponentTemplate(
        options.name,
        options.description,
        options.hidden,
        options.env
      );
  }
}
